#!/usr/bin/env python3

from socket import *
from Exploit import Exploit

#example basic exploit test in its own class file
class Stand_Alone_Exploit(Exploit):
    def __init__(self, ip, port, name="", debug=False, debug_chaff=False):
        super().__init__(ip, port, name, debug, debug_chaff)

    def launch_exploit(self):
        # this is where you would write your own exploit code.
        # The end state is that you should return the flag
        #return "CTF{THISISMYSTANDALONEFLAG}"

        #The below is functional test code if using server.py in test_server
        #just comment out the above return line
        recv_msg = self.recv_until('\n')
        flag = self.recv_until('\n').split(': ',1)[1].strip()
        return flag

    def launch_chaff(self):
        #This is where you would write a fake exploit that does not really
        #work, but looks real enough to cause them to waste time looking for
        #the real exploit.
        #pass

        #The below is functional test code if using server.py in test_server
        #just comment out the above pass line
        recv_msg = self.recv_until()
